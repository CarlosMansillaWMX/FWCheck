<?xml version="1.0" encoding="utf-8"?>
<configuration>
<configSections>
    <sectionGroup name="userSettings" type="System.Configuration.UserSettingsGroup, System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">
        <section name="LoginApplication.Properties.Settings" type="System.Configuration.ClientSettingsSection, System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" allowExeDefinition="MachineToLocalUser" requirePermission="false" />
    </sectionGroup>
</configSections>
<startup><supportedRuntime version="v4.0" sku=".NETFramework,Version=v4.8" /></startup><userSettings>
        <LoginApplication.Properties.Settings>
            <setting name="GetSensors" serializeAs="String">
                <value>$COM = [System.IO.Ports.SerialPort]::getportnames()
# loop throught $COM, connecting to each and verifying it is an LED Analyser
# if it's IR, do the IR tests, and if it's normal LED do the normal tests
ForEach ($line in $($COM -split "`r`n"))
{
    (&amp;{If($LEDPort -and $IRPort -and $ARDPort -and $PSPort) {break}})
    $ErrorActionPreference = 'SilentlyContinue'
    $port = New-Object System.IO.Ports.SerialPort $line,57600,None,8,one
    $port.open()
    $port.writeline("getHW")
    sleep -Milliseconds 100
    $hwversion = $port.ReadExisting()
    if ($hwversion -Match "Feasa")
    {
        if ($hwversion -Match "IR")
        {
            $global:IRPort = $line
            echo "IR: " $IRPort
        }
        else
        {
            $global:LEDPort = $line
            echo "LED: " $LEDPort
        } 
    }
    elseif (-not $ARDPort -or -not $PSPort)
    {
        $port.close()
        $port = New-Object System.IO.Ports.SerialPort $line,9600,None,8,one
        $port.open()
        $port.ReadExisting()
        $port.writeline("6")
        sleep -Milliseconds 100
        $deviceID = $port.ReadExisting()
        if ($deviceID -Match "Arduino")
        {
            $global:ARDPort = $line
            echo "ARD: " $ARDPort
        }
        else
        {
            $port.writeline("*IDN?")
            sleep -Milliseconds 100
            $deviceID = $port.ReadExisting()
            if ($deviceID -Match "GPD")
            {
                $global:PSPort = $line
                echo "PS: " $PSPort
            }
        }
    }
    $port.close()
}</value>
            </setting>
            <setting name="rigolsID" serializeAs="String">
                <value>USB0::0x1AB1::0x0643::DG8A223502727::INSTR</value>
            </setting>
            <setting name="externalLight" serializeAs="String">
                <value>False</value>
            </setting>
            <setting name="keithleyID" serializeAs="String">
                <value>USB0::0x05E6::0x2281::4562088::INSTR</value>
            </setting>
            <setting name="rfTester" serializeAs="String">
                <value>USB0::0x0B5B::0xFFF9::2109059_5928_52::INSTR</value>
            </setting>
            <setting name="testCategory" serializeAs="String">
                <value>0</value>
            </setting>
            <setting name="testStationNumber" serializeAs="String">
                <value>1</value>
            </setting>
            <setting name="rfwaittime" serializeAs="String">
                <value>0</value>
            </setting>
            <setting name="Ibatwaittime" serializeAs="String">
                <value>2</value>
            </setting>
            <setting name="captureWaitMs" serializeAs="String">
                <value>1500</value>
            </setting>
            <setting name="gthreshold" serializeAs="String">
                <value>2</value>
            </setting>
            <setting name="gtimeLowerThreshold" serializeAs="String">
                <value>1.5</value>
            </setting>
            <setting name="gdiffthreshold" serializeAs="String">
                <value>5</value>
            </setting>
            <setting name="birdSleep" serializeAs="String">
                <value>2</value>
            </setting>
            <setting name="photodiodeLEDCurrentPercentage" serializeAs="String">
                <value>10</value>
            </setting>
            <setting name="pathToCal" serializeAs="String">
                <value>1.cal</value>
            </setting>
            <setting name="startFreq" serializeAs="String">
                <value>15000000</value>
            </setting>
            <setting name="stopFreq" serializeAs="String">
                <value>18000000</value>
            </setting>
            <setting name="points" serializeAs="String">
                <value>201</value>
            </setting>
            <setting name="pAvg" serializeAs="String">
                <value>30</value>
            </setting>
            <setting name="BPNFCLower" serializeAs="String">
                <value>14.92</value>
            </setting>
            <setting name="BPNFCUpper" serializeAs="String">
                <value>15.44</value>
            </setting>
            <setting name="StrapNFCLower" serializeAs="String">
                <value>15.85</value>
            </setting>
            <setting name="StrapNFCUpper" serializeAs="String">
                <value>16.64</value>
            </setting>
            <setting name="BPCoilOffset" serializeAs="String">
                <value>0</value>
            </setting>
            <setting name="StrapCoilOffset" serializeAs="String">
                <value>0.04</value>
            </setting>
            <setting name="serverIP" serializeAs="String">
                <value>172.16.16.2:8000</value>
            </setting>
            <setting name="ledSensitivityFactor" serializeAs="String">
                <value>1</value>
            </setting>
            <setting name="sfcConfig" serializeAs="String">
                <value>0</value>
            </setting>
            <setting name="comPort" serializeAs="String">
                <value>COM~</value>
            </setting>
            <setting name="debugMode" serializeAs="String">
                <value>False</value>
            </setting>
            <setting name="znleID" serializeAs="String">
                <value>TCPIP::172.0.0.2::INSTR</value>
            </setting>
            <setting name="portNum" serializeAs="String">
                <value>1</value>
            </setting>
        </LoginApplication.Properties.Settings>
    </userSettings>
  <runtime>
    <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
      <dependentAssembly>
        <assemblyIdentity name="System.Management.Automation" publicKeyToken="31bf3856ad364e35" culture="neutral" />
        <bindingRedirect oldVersion="0.0.0.0-3.0.0.0" newVersion="3.0.0.0" />
      </dependentAssembly>
    </assemblyBinding>
  </runtime>
</configuration>
